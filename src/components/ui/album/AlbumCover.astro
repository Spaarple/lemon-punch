---
export interface Props {
    image?: {
        source_url: string;
        alt?: string;
    };
    title: string;
    size?: 'main' | 'older' | 'standard';
    showPlayButton?: boolean;
    href?: string;
    releaseType?: string;
}

const {
    image,
    title,
    size = 'standard',
    showPlayButton = true,
    href,
    releaseType
} = Astro.props;

const sizeClasses = {
    main: 'main-cover-image',
    older: 'older-cover-image',
    standard: 'cover-image'
};

const overlayClasses = {
    main: 'main-cover-overlay',
    older: 'older-cover-overlay',
    standard: 'cover-overlay'
};
---

<div class={`album-cover ${size}-album-cover`}>
    {image?.source_url ? (
        <img
            src={image.source_url}
            alt={image.alt || `Pochette de ${title}`}
            class={`${sizeClasses[size]}`}
        />
    ) : (
        <div class={`${sizeClasses[size]} placeholder`}>
            <span>Pas d'image</span>
        </div>
    )}

    {showPlayButton && (
        <div class={overlayClasses[size]}>
            <i class="fas fa-play"></i>
        </div>
    )}

    {releaseType && (
        <div class={`release-type-badge ${size}-badge ${releaseType.toLowerCase()}`}>
            {releaseType}
        </div>
    )}

    {href && <a href={href} class="album-cover-link" aria-label={`Voir ${title}`}></a>}
</div>

<style>
    .album-cover {
        position: relative;
        cursor: pointer;
    }

    .album-cover-link {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 4;
    }

    /* Images */
    .cover-image, .main-cover-image, .older-cover-image {
        object-fit: cover;
        transition: all 0.4s ease;
    }

    .main-cover-image {
        width: 400px;
        height: 400px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    }

    .older-cover-image {
        width: 250px;
        height: 250px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    }

    .cover-image {
        width: 300px;
        height: 300px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .placeholder {
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--light-gray);
        color: var(--gray);
        border: 2px dashed var(--gray);
        font-weight: 600;
    }

    /* Overlays */
    .cover-overlay, .main-cover-overlay, .older-cover-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: all 0.4s ease;
    }

    .album-cover:hover .cover-overlay,
    .album-cover:hover .main-cover-overlay,
    .album-cover:hover .older-cover-overlay {
        opacity: 1;
    }

    .album-cover:hover .main-cover-image {
        transform: scale(1.03);
        box-shadow: 0 25px 80px rgba(0, 0, 0, 0.25);
    }

    .album-cover:hover .older-cover-image {
        transform: scale(1.05);
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
    }

    .album-cover:hover .cover-image {
        transform: scale(1.04);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    }

    .main-cover-overlay i {
        font-size: 4rem;
        color: var(--white);
    }

    .older-cover-overlay i,
    .cover-overlay i {
        font-size: 3rem;
        color: var(--white);
    }

    /* Release Type Badge */
    .release-type-badge {
        position: absolute;
        display: inline-block;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        border: 2px solid;
        z-index: 3;
        backdrop-filter: blur(10px);
    }

    .main-badge {
        font-size: 1rem;
        padding: 8px 16px;
        top: 20px;
        left: 20px;
    }

    .older-badge {
        font-size: 0.7rem;
        padding: 4px 10px;
        top: 10px;
        left: 10px;
    }

    .standard-badge {
        font-size: 0.8rem;
        padding: 6px 12px;
        top: 15px;
        left: 15px;
    }

    .release-type-badge.album {
        background: rgba(244, 208, 63, 0.9);
        color: var(--black);
        border-color: var(--primary-yellow);
    }

    .release-type-badge.single {
        background: rgba(255, 107, 53, 0.9);
        color: var(--white);
        border-color: #ff6b35;
    }

    .release-type-badge.ep {
        background: rgba(46, 204, 113, 0.9);
        color: var(--white);
        border-color: #2ecc71;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .main-cover-image {
            width: 320px;
            height: 320px;
        }

        .older-cover-image {
            width: 200px;
            height: 200px;
        }

        .cover-image {
            width: 250px;
            height: 250px;
        }
    }

    @media (max-width: 480px) {
        .main-cover-image {
            width: 280px;
            height: 280px;
        }

        .older-cover-image {
            width: 180px;
            height: 180px;
        }

        .cover-image {
            width: 220px;
            height: 220px;
        }
    }
</style>